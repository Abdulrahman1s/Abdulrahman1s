name: Feedback
on:
  issues:
    types: [labeled, edited]
  push:
    paths: ["assets/feedback.json", "scripts/feedback.py"]
  schedule: [{cron: "0 0 * * FRI"}]
  workflow_dispatch:
jobs:
  run:
    runs-on: ubuntu-latest
    steps:
       - uses: actions/checkout@v3
       - if: github.event_name == 'issues' && github.event.label.name == 'feedback'
         uses: peter-evans/close-issue@v2
         with:
          comment: |
            Thank you very much. I really appreciate your feedback. <3
       - name: Fetch Feedback
         run: python scripts/feedback.py
         env: 
           BODY: ${{ github.event.issue.body }}
           CREATED_AT: ${{ github.event.issue.created_at }}
           USER_ID: ${{ github.event.issue.user.id }}
           USERNAME: ${{ github.event.issue.user.login }}
           AVATAR_URL: ${{ github.event.issue.user.avatar_url }}
       - name: Push changes
         run: |
               git config --global user.name "github-actions"
               git config --global user.email "github-actions@github.com"
               git pull
               git add -A
               git commit -m "Update github feedback"
               git push
